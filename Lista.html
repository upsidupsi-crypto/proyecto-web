<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista Enlazada</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav>
        <a href="Proyecto.html">Inicio</a> |
        <a href="Pila.html">Pila</a> |
        <a href="Cola.html">Cola</a> |
        <a href="Lista.html">Lista Enlazada</a>
    </nav>
    <h1>Lista Enlazada</h1>
    
    <div class="control-section">
        <input type="text" id="inputLista" placeholder="Ingrese un número">
        <button onclick="app.insertarInicio()">Insertar Inicio</button>
        <button onclick="app.insertarFinal()">Insertar Final</button>
        <button onclick="app.eliminar()">Eliminar Valor</button>
        <p id="mensaje"></p>
    </div>

    <div class="content-container">
        <div class="visualization-container">
            <h3>Visualización:</h3>
            <div id="lienzo" data-structure="lista">La lista está vacía</div>
        </div>

        <div class="code-container">
            <h3>Código C:</h3>
            <pre id="codigoDisplay">Seleccione una operación...</pre>
        </div>
    </div>

    <script>
        const CODIGO_C = {
            inicio: `void insertarInicio(Nodo** cabeza, int dato) {
    Nodo* nuevoNodo = (Nodo*)malloc(sizeof(Nodo));
    nuevoNodo->dato = dato;
    nuevoNodo->siguiente = *cabeza;
    *cabeza = nuevoNodo;
}`,
            final: `void insertarFinal(Nodo** cabeza, int dato) {
    Nodo* nuevoNodo = (Nodo*)malloc(sizeof(Nodo));
    nuevoNodo->dato = dato;
    nuevoNodo->siguiente = NULL;
    if (*cabeza == NULL) {
        *cabeza = nuevoNodo;
        return;
    }
    Nodo* actual = *cabeza;
    while (actual->siguiente != NULL) actual = actual->siguiente;
    actual->siguiente = nuevoNodo;
}`,
            eliminar: `void eliminar(Nodo** cabeza, int valor) {
    Nodo* actual = *cabeza;
    Nodo* anterior = NULL;
    while (actual != NULL && actual->dato != valor) {
        anterior = actual;
        actual = actual->siguiente;
    }
    if (actual == NULL) return;
    if (anterior == NULL) *cabeza = actual->siguiente;
    else anterior->siguiente = actual->siguiente;
    free(actual);
}`
        };

        const app = {
            datos: [], 
            
            /**
             * Inserta un nodo al principio de la lista.
             * Utiliza unshift para colocar el elemento en el índice 0 del arreglo.
             */
            insertarInicio() {
                const val = this.getVal();
                if (val === null) return;
                this.datos.unshift(val);
                this.render();
                this.mostrarCodigo(CODIGO_C.inicio);
                this.mensaje(`Insertado inicio: ${val}`);
            },

            /**
             * Inserta un nodo al final de la lista.
             * Utiliza push para colocar el elemento en el último índice.
             */
            insertarFinal() {
                const val = this.getVal();
                if (val === null) return;
                this.datos.push(val);
                this.render();
                this.mostrarCodigo(CODIGO_C.final);
                this.mensaje(`Insertado final: ${val}`);
            },

            /**
             * Busca y elimina un nodo basado en su valor.
             * Busca el índice del valor y si existe lo elimina usando splice.
             */
            eliminar() {
                const val = this.getVal();
                if (val === null) return;
                const idx = this.datos.indexOf(String(val));
                if (idx === -1) return this.mensaje('Valor no encontrado');
                this.datos.splice(idx, 1);
                this.render();
                this.mostrarCodigo(CODIGO_C.eliminar);
                this.mensaje(`Eliminado: ${val}`);
            },

            /**
             * Dibuja la lista enlazada en el DOM.
             * Crea divs para los nodos y flechas (->) entre ellos.
             */
            render() {
                const div = document.getElementById('lienzo');
                div.innerHTML = '';
                if (this.datos.length === 0) {
                    div.innerHTML = 'NULL';
                    return;
                }
                this.datos.forEach(d => {
                    const caja = document.createElement('div');
                    caja.style.border = "1px solid black";
                    caja.style.padding = "5px";
                    caja.className = 'nodo-entrada';
                    caja.textContent = d;
                    div.appendChild(caja);
                    
                    const flecha = document.createElement('span');
                    flecha.innerHTML = "&nbsp;&rarr;&nbsp;";
                    div.appendChild(flecha);
                });
                const fin = document.createElement('span');
                fin.textContent = "NULL";
                div.appendChild(fin);
            },

            /**
             * Función auxiliar para obtener y validar el valor del input.
             */
            getVal() {
                const input = document.getElementById('inputLista');
                const val = input.value.trim();
                if (!val || isNaN(val)) {
                    alert("Ingrese un número");
                    return null;
                }
                input.value = '';
                input.focus();
                return val;
            },

            // Función auxiliar para inyectar el código C en el HTML
            mostrarCodigo(txt) {
                document.getElementById('codigoDisplay').innerHTML = txt.replace(/\n/g, '<br>').replace(/ /g, '&nbsp;');
            },
            
            // Función auxiliar para mostrar notificaciones breves
            mensaje(txt) {
                document.getElementById('mensaje').textContent = txt;
            }
        };
    </script>
</body>
</html>